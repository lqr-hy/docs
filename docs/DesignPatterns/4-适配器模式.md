# 适配器模式

- 适配器模式（Adapter Pattern）是一种常见的设计模式，用于将一个类的接口转换成客户端期望的另一个接口。它允许不兼容接口的类可以相互合作。

适配器模式通常包括以下几个角色：

1. **目标接口（Target）**：客户端所期待的接口，适配器通过实现这个接口来与客户端进行交互。
2. **适配器（Adapter）**：将不兼容的接口转换成目标接口的类。
3. **适配者（Adaptee）**：需要被适配的类。
4. **客户端（Client）**：与目标接口交互的类。

- 适配器模式可以分为两种实现方式：类适配器模式和对象适配器模式。
  > **类适配器模式**：通过继承适配者类和实现目标接口来实现适配器。
  >
  > **对象适配器模式**：通过组合适配者类的实例，并实现目标接口来实现适配器。

1. **_优点：_**

   - **解耦性强：** 适配器模式可以将客户端与目标类解耦，因为客户端只需要与目标接口交互，而不需要直接与适配者类交互。这样一来，如果需要更改适配者类，客户端的代码就不需要修改。
   - **复用性好：** 适配器模式允许重用已经存在的类  ，因为它可以使现有的类与需要的接口相匹配。这样一来，我们可以利用现有的功能，而不需要重复编写相似的功能。
   - **灵活性强：** 适配器模式很灵活，可以根据需要动态地添加适配器来适配不同的接口。这样一来，我们可以适配不同的类和接口，以满足不同的需求。
   - **单一职责原则：** 适配器模式遵循单一职责原则，因为它将适配逻辑封装在适配器中，使得每个类都只负责一种功能。

2. **_缺点：_**

   - **增加复杂性：** 在引入适配器模式后，系统中会增加额外的类和对象，从而增加了复杂性。特别是在对象适配器模式中，适配器需要持有一个适配者对象的引用，这会增加一定的复杂度。
   - **可能导致性能损失：** 在适配器模式中，适配器需要进行额外的转换操作，这可能会导致性能损失。特别是在高性能要求的系统中，需要仔细评估适配器的实现方式，以确保性能不受影响。
   - **可能引入不必要的抽象：** 如果系统中存在大量的适配器，可能会导致过度的抽象化，使得系统变得难以理解和维护。

3. **_使用场景_**

   - **集成现有系统：** 当需要集成一个已经存在的类或系统到新的系统中，但是它的接口与现有系统不兼容时，可以使用适配器模式来进行适配。
   - **使用第三方库：** 当需要使用第三方库或框架提供的功能，但是其接口与当前系统的接口不匹配时，可以编写适配器来进行适配。
   - **封装不稳定的接口：** 当某个接口比较不稳定，经常发生变化时，可以使用适配器模式来封装这个接口，从而降低变化对系统的影响。
   - **复用已有功能：** 当需要复用已经存在的功能，但是其接口与当前系统的接口不匹配时，可以使用适配器模式来适配这个功能。
   - **兼容不同版本：** 当需要兼容不同版本的接口时，可以使用适配器模式来适配不同版本的接口，从而使得系统具有更好的兼容性。

:::details Demo

```ts
// 被适配的类：MP4 播放器
class Mp4Player {
  playMp4(filename: string): void {
    console.log(`Playing MP4 file: ${filename}`)
  }
}

// 目标接口：音频播放器
interface AudioPlayer {
  play(audioType: string, filename: string): void
}

// 适配器类：将 MP4 播放器适配成音频播放器
class MediaAdapter implements AudioPlayer {
  private mp4Player: Mp4Player

  constructor() {
    this.mp4Player = new Mp4Player()
  }

  play(audioType: string, filename: string): void {
    if (audioType === 'mp4') {
      this.mp4Player.playMp4(filename)
    } else {
      console.log(`Invalid media type: ${audioType}`)
    }
  }
}

// 客户端代码
const audioPlayer: AudioPlayer = new MediaAdapter()
audioPlayer.play('mp4', 'movie.mp4') // 播放 MP4 音频
```

:::
